--------------------------------------------------------
--  DDL for View LTE_5060E_MONTH
--------------------------------------------------------

  CREATE OR REPLACE VIEW "HARRIAGUE"."LTE_5060E_MONTH" ("PERIOD_START_TIME", "CO_NAME", "LTE_5060E_NUM_1", "LTE_5060E_DEN_1", "LTE_5060E_NUM_2", "LTE_5060E_DEN_2", "LTE_5060E") AS 
  SELECT TRUNC( PERIOD_START_TIME  , 'MONTH') AS PERIOD_START_TIME, CO_NAME, SUM(LTE_5060E_NUM_1) AS LTE_5060E_NUM_1,
SUM(LTE_5060E_DEN_1) AS LTE_5060E_DEN_1, SUM(LTE_5060E_NUM_2) AS LTE_5060E_NUM_2,
SUM(LTE_5060E_DEN_2) AS LTE_5060E_DEN_2,
      ROUND (((DECODE (SUM(LTE_5060E_DEN_1), 0, 0, SUM(LTE_5060E_NUM_1) / SUM(LTE_5060E_DEN_1)) *
      DECODE (SUM(LTE_5060E_DEN_2), 0, 0, SUM(LTE_5060E_NUM_2) / SUM(LTE_5060E_DEN_2)))*100),2) as LTE_5060E
FROM LTE_5060E_HISTORICAL
GROUP BY TRUNC( PERIOD_START_TIME  , 'MONTH'), CO_NAME
;
