--------------------------------------------------------
--  DDL for Procedure P_LTE_C_LCELLD_RAW_REPLAY
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "HARRIAGUE"."P_LTE_C_LCELLD_RAW_REPLAY" (P_FECHA_DESDE IN CHAR, P_FECHA_HASTA IN CHAR)
IS
  sql_stmt VARCHAR2(32767);

  TYPE cur_typ IS REF CURSOR;
  cur CUR_TYP;
  limit_in PLS_INTEGER := 100;

 v_bulk_errors EXCEPTION;
PRAGMA EXCEPTION_INIT (v_bulk_errors, -24381);

  -- LOG --
  l_errors VARCHAR2 (4000);
  l_errno    VARCHAR2(4000);
  l_msg    varchar2(4000);
  l_idx    VARCHAR2(4000);
  -- END LOG --

  TYPE t_array_tab IS TABLE OF NOKLTE_PS_LCELLD_MNC1_RAW%ROWTYPE;
  t_array_col t_array_tab;


 BEGIN

    sql_stmt := ' SELECT DISTINCT
r.MRBTS_ID,
r.LNBTS_ID,
r.LNCEL_ID,
r.MCC_ID,
r.MNC_ID,
r.PERIOD_START_TIME + 7 PERIOD_START_TIME,
r.PERIOD_DURATION,
r.PERIOD_DURATION_SUM,
r.PDCP_SDU_DELAY_DL_DTCH_MIN,
r.PDCP_SDU_DELAY_DL_DTCH_MAX,
r.PDCP_SDU_DELAY_DL_DTCH_MEAN,
r.PDCP_SDU_DELAY_UL_DTCH_MIN,
r.PDCP_SDU_DELAY_UL_DTCH_MAX,
r.PDCP_SDU_DELAY_UL_DTCH_MEAN,
r.RACH_STP_ATT_SMALL_MSG,
r.RACH_STP_ATT_LARGE_MSG,
r.RACH_STP_COMPLETIONS,
r.TRANSMIT_TB_ON_PCH,
r.TRANSMIT_TB_ON_BCH,
r.TRANSMIT_TB_ON_DL_SCH,
r.HARQ_RETRANS_ON_DL_SCH,
r.CORR_NON_DUPL_UL_SCH_TB,
r.CORR_UL_SCH_TB_RE_RECEPT,
r.INCORR_UL_SCH_TB_RECEPT,
r.PUSCH_TRANS_USING_MCS0,
r.PUSCH_TRANS_USING_MCS1,
r.PUSCH_TRANS_USING_MCS2,
r.PUSCH_TRANS_USING_MCS3,
r.PUSCH_TRANS_USING_MCS4,
r.PUSCH_TRANS_USING_MCS5,
r.PUSCH_TRANS_USING_MCS6,
r.PUSCH_TRANS_USING_MCS7,
r.PUSCH_TRANS_USING_MCS8,
r.PUSCH_TRANS_USING_MCS9,
r.PUSCH_TRANS_USING_MCS10,
r.PUSCH_TRANS_USING_MCS11,
r.PUSCH_TRANS_USING_MCS12,
r.PUSCH_TRANS_USING_MCS13,
r.PUSCH_TRANS_USING_MCS14,
r.PUSCH_TRANS_USING_MCS15,
r.PUSCH_TRANS_USING_MCS16,
r.PUSCH_TRANS_USING_MCS17,
r.PUSCH_TRANS_USING_MCS18,
r.PUSCH_TRANS_USING_MCS19,
r.PUSCH_TRANS_USING_MCS20,
r.PUSCH_TRANS_USING_MCS21,
r.PUSCH_TRANS_USING_MCS22,
r.PUSCH_TRANS_USING_MCS23,
r.PUSCH_TRANS_USING_MCS24,
r.PUSCH_TRANS_USING_MCS25,
r.PUSCH_TRANS_USING_MCS26,
r.PUSCH_TRANS_USING_MCS27,
r.PUSCH_TRANS_USING_MCS28,
r.PDSCH_TRANS_USING_MCS0,
r.PDSCH_TRANS_USING_MCS1,
r.PDSCH_TRANS_USING_MCS2,
r.PDSCH_TRANS_USING_MCS3,
r.PDSCH_TRANS_USING_MCS4,
r.PDSCH_TRANS_USING_MCS5,
r.PDSCH_TRANS_USING_MCS6,
r.PDSCH_TRANS_USING_MCS7,
r.PDSCH_TRANS_USING_MCS8,
r.PDSCH_TRANS_USING_MCS9,
r.PDSCH_TRANS_USING_MCS10,
r.PDSCH_TRANS_USING_MCS11,
r.PDSCH_TRANS_USING_MCS12,
r.PDSCH_TRANS_USING_MCS13,
r.PDSCH_TRANS_USING_MCS14,
r.PDSCH_TRANS_USING_MCS15,
r.PDSCH_TRANS_USING_MCS16,
r.PDSCH_TRANS_USING_MCS17,
r.PDSCH_TRANS_USING_MCS18,
r.PDSCH_TRANS_USING_MCS19,
r.PDSCH_TRANS_USING_MCS20,
r.PDSCH_TRANS_USING_MCS21,
r.PDSCH_TRANS_USING_MCS22,
r.PDSCH_TRANS_USING_MCS23,
r.PDSCH_TRANS_USING_MCS24,
r.PDSCH_TRANS_USING_MCS25,
r.PDSCH_TRANS_USING_MCS26,
r.PDSCH_TRANS_USING_MCS27,
r.PDSCH_TRANS_USING_MCS28,
r.PUSCH_TRANS_NACK_MCS0,
r.PUSCH_TRANS_NACK_MCS1,
r.PUSCH_TRANS_NACK_MCS2,
r.PUSCH_TRANS_NACK_MCS3,
r.PUSCH_TRANS_NACK_MCS4,
r.PUSCH_TRANS_NACK_MCS5,
r.PUSCH_TRANS_NACK_MCS6,
r.PUSCH_TRANS_NACK_MCS7,
r.PUSCH_TRANS_NACK_MCS8,
r.PUSCH_TRANS_NACK_MCS9,
r.PUSCH_TRANS_NACK_MCS10,
r.PUSCH_TRANS_NACK_MCS11,
r.PUSCH_TRANS_NACK_MCS12,
r.PUSCH_TRANS_NACK_MCS13,
r.PUSCH_TRANS_NACK_MCS14,
r.PUSCH_TRANS_NACK_MCS15,
r.PUSCH_TRANS_NACK_MCS16,
r.PUSCH_TRANS_NACK_MCS17,
r.PUSCH_TRANS_NACK_MCS18,
r.PUSCH_TRANS_NACK_MCS19,
r.PUSCH_TRANS_NACK_MCS20,
r.PUSCH_TRANS_NACK_MCS21,
r.PUSCH_TRANS_NACK_MCS22,
r.PUSCH_TRANS_NACK_MCS23,
r.PUSCH_TRANS_NACK_MCS24,
r.PUSCH_TRANS_NACK_MCS25,
r.PUSCH_TRANS_NACK_MCS26,
r.PUSCH_TRANS_NACK_MCS27,
r.PUSCH_TRANS_NACK_MCS28,
r.PDSCH_TRANS_NACK_MCS0,
r.PDSCH_TRANS_NACK_MCS1,
r.PDSCH_TRANS_NACK_MCS2,
r.PDSCH_TRANS_NACK_MCS3,
r.PDSCH_TRANS_NACK_MCS4,
r.PDSCH_TRANS_NACK_MCS5,
r.PDSCH_TRANS_NACK_MCS6,
r.PDSCH_TRANS_NACK_MCS7,
r.PDSCH_TRANS_NACK_MCS8,
r.PDSCH_TRANS_NACK_MCS9,
r.PDSCH_TRANS_NACK_MCS10,
r.PDSCH_TRANS_NACK_MCS11,
r.PDSCH_TRANS_NACK_MCS12,
r.PDSCH_TRANS_NACK_MCS13,
r.PDSCH_TRANS_NACK_MCS14,
r.PDSCH_TRANS_NACK_MCS15,
r.PDSCH_TRANS_NACK_MCS16,
r.PDSCH_TRANS_NACK_MCS17,
r.PDSCH_TRANS_NACK_MCS18,
r.PDSCH_TRANS_NACK_MCS19,
r.PDSCH_TRANS_NACK_MCS20,
r.PDSCH_TRANS_NACK_MCS21,
r.PDSCH_TRANS_NACK_MCS22,
r.PDSCH_TRANS_NACK_MCS23,
r.PDSCH_TRANS_NACK_MCS24,
r.PDSCH_TRANS_NACK_MCS25,
r.PDSCH_TRANS_NACK_MCS26,
r.PDSCH_TRANS_NACK_MCS27,
r.PDSCH_TRANS_NACK_MCS28,
r.RLC_SDU_ON_DL_DTCH,
r.RLC_SDU_ON_DL_DCCH,
r.DISC_SDU_ON_DL_DTCH,
r.RLC_SDU_ON_UL_DTCH,
r.RLC_SDU_ON_UL_DCCH,
r.RLC_PDU_FIRST_TRANS,
r.RLC_PDU_RE_TRANS,
r.UL_RLC_PDU_DUPL_REC,
r.UL_RLC_PDU_RETR_REQ,
r.UL_RLC_PDU_DISC,
r.DL_UE_DATA_BUFF_AVG,
r.DL_UE_DATA_BUFF_MAX,
r.UL_UE_DATA_BUFF_AVG,
r.UL_UE_DATA_BUFF_MAX,
r.PDCP_SDU_UL,
r.PDCP_SDU_DL,
r.PDCP_SDU_DL_DISC,
r.TB_BAD_PDSCH_MCS0,
r.TB_BAD_PDSCH_MCS1,
r.TB_BAD_PDSCH_MCS2,
r.TB_BAD_PDSCH_MCS3,
r.TB_BAD_PDSCH_MCS4,
r.TB_BAD_PDSCH_MCS5,
r.TB_BAD_PDSCH_MCS6,
r.TB_BAD_PDSCH_MCS7,
r.TB_BAD_PDSCH_MCS8,
r.TB_BAD_PDSCH_MCS9,
r.TB_BAD_PDSCH_MCS10,
r.TB_BAD_PDSCH_MCS11,
r.TB_BAD_PDSCH_MCS12,
r.TB_BAD_PDSCH_MCS13,
r.TB_BAD_PDSCH_MCS14,
r.TB_BAD_PDSCH_MCS15,
r.TB_BAD_PDSCH_MCS16,
r.TB_BAD_PDSCH_MCS17,
r.TB_BAD_PDSCH_MCS18,
r.TB_BAD_PDSCH_MCS19,
r.TB_BAD_PDSCH_MCS20,
r.TB_BAD_PUSCH_MCS0,
r.TB_BAD_PUSCH_MCS1,
r.TB_BAD_PUSCH_MCS2,
r.TB_BAD_PUSCH_MCS3,
r.TB_BAD_PUSCH_MCS4,
r.TB_BAD_PUSCH_MCS5,
r.TB_BAD_PUSCH_MCS6,
r.TB_BAD_PUSCH_MCS7,
r.TB_BAD_PUSCH_MCS8,
r.TB_BAD_PUSCH_MCS9,
r.TB_BAD_PUSCH_MCS10,
r.TB_BAD_PUSCH_MCS11,
r.TB_BAD_PUSCH_MCS12,
r.TB_BAD_PUSCH_MCS13,
r.TB_BAD_PUSCH_MCS14,
r.TB_BAD_PUSCH_MCS15,
r.TB_BAD_PUSCH_MCS16,
r.TB_BAD_PUSCH_MCS17,
r.TB_BAD_PUSCH_MCS18,
r.TB_BAD_PUSCH_MCS19,
r.TB_BAD_PUSCH_MCS20,
r.RRC_CONN_UE_AVG,
r.RRC_CONN_UE_MAX,
r.TB_BAD_PDSCH_MCS21,
r.TB_BAD_PDSCH_MCS22,
r.TB_BAD_PDSCH_MCS23,
r.TB_BAD_PDSCH_MCS24,
r.TB_BAD_PDSCH_MCS25,
r.TB_BAD_PDSCH_MCS26,
r.TB_BAD_PDSCH_MCS27,
r.TB_BAD_PDSCH_MCS28,
r.DL_QUE_L_SRB_MIN,
r.DL_QUE_L_SRB_AVG,
r.DL_QUE_L_SRB_MAX,
r.DL_QUE_L_DRB_MIN,
r.DL_QUE_L_DRB_AVG,
r.DL_QUE_L_DRB_MAX,
r.DL_RLC_C_PDU_FIRST_TIME,
r.DL_RLC_D_PDU_FIRST_TIME,
r.DL_RLC_SDU_FROM_PDCP,
r.RLC_SDU_BCCH,
r.RLC_SDU_DL_CCCH,
r.RLC_SDU_PCCH,
r.RLC_SDU_DL_DCCH_DISC,
r.RLC_SDU_UL_CCCH,
r.UL_RLC_PDU_RECECPTION,
r.UL_RLC_PDU_REC_TOT,
r.CELL_LOAD_ACT_UE_AVG,
r.CELL_LOAD_ACT_UE_MAX,
r.UE_DRB_DL_DATA_QCI_1,
r.PDCP_RET_DL_DEL_MEAN_QCI_1,
r.PDCP_RET_DL_DEL_MEAN_QCI_2,
r.PDCP_SDU_UL_QCI_1,
r.PDCP_SDU_DL_QCI_1,
r.PDCP_SDU_DISC_DL_QCI_1,
r.TB_BUND2_NACK_PDSCH_MCS0,
r.TB_BUND2_NACK_PDSCH_MCS1,
r.TB_BUND2_NACK_PDSCH_MCS2,
r.TB_BUND2_NACK_PDSCH_MCS3,
r.TB_BUND2_NACK_PDSCH_MCS4,
r.TB_BUND2_NACK_PDSCH_MCS5,
r.TB_BUND2_NACK_PDSCH_MCS6,
r.TB_BUND2_NACK_PDSCH_MCS7,
r.TB_BUND2_NACK_PDSCH_MCS8,
r.TB_BUND2_NACK_PDSCH_MCS9,
r.TB_BUND2_NACK_PDSCH_MCS10,
r.TB_BUND2_NACK_PDSCH_MCS11,
r.TB_BUND2_NACK_PDSCH_MCS12,
r.TB_BUND2_NACK_PDSCH_MCS13,
r.TB_BUND2_NACK_PDSCH_MCS14,
r.TB_BUND2_NACK_PDSCH_MCS15,
r.TB_BUND2_NACK_PDSCH_MCS16,
r.TB_BUND2_NACK_PDSCH_MCS17,
r.TB_BUND2_NACK_PDSCH_MCS18,
r.TB_BUND2_NACK_PDSCH_MCS19,
r.TB_BUND2_NACK_PDSCH_MCS20,
r.TB_BUND2_NACK_PDSCH_MCS21,
r.TB_BUND2_NACK_PDSCH_MCS22,
r.TB_BUND2_NACK_PDSCH_MCS23,
r.TB_BUND2_NACK_PDSCH_MCS24,
r.TB_BUND2_NACK_PDSCH_MCS25,
r.TB_BUND2_NACK_PDSCH_MCS26,
r.TB_BUND2_NACK_PDSCH_MCS27,
r.TB_BUND2_NACK_PDSCH_MCS28,
r.TB_BUND3_NACK_PDSCH_MCS0,
r.TB_BUND3_NACK_PDSCH_MCS1,
r.TB_BUND3_NACK_PDSCH_MCS2,
r.TB_BUND3_NACK_PDSCH_MCS3,
r.TB_BUND3_NACK_PDSCH_MCS4,
r.TB_BUND3_NACK_PDSCH_MCS5,
r.TB_BUND3_NACK_PDSCH_MCS6,
r.TB_BUND3_NACK_PDSCH_MCS7,
r.TB_BUND3_NACK_PDSCH_MCS8,
r.TB_BUND3_NACK_PDSCH_MCS9,
r.TB_BUND3_NACK_PDSCH_MCS10,
r.TB_BUND3_NACK_PDSCH_MCS11,
r.TB_BUND3_NACK_PDSCH_MCS12,
r.TB_BUND3_NACK_PDSCH_MCS13,
r.TB_BUND3_NACK_PDSCH_MCS14,
r.TB_BUND3_NACK_PDSCH_MCS15,
r.TB_BUND3_NACK_PDSCH_MCS16,
r.TB_BUND3_NACK_PDSCH_MCS17,
r.TB_BUND3_NACK_PDSCH_MCS18,
r.TB_BUND3_NACK_PDSCH_MCS19,
r.TB_BUND3_NACK_PDSCH_MCS20,
r.TB_BUND3_NACK_PDSCH_MCS21,
r.TB_BUND3_NACK_PDSCH_MCS22,
r.TB_BUND3_NACK_PDSCH_MCS23,
r.TB_BUND3_NACK_PDSCH_MCS24,
r.TB_BUND3_NACK_PDSCH_MCS25,
r.TB_BUND3_NACK_PDSCH_MCS26,
r.TB_BUND3_NACK_PDSCH_MCS27,
r.TB_BUND3_NACK_PDSCH_MCS28,
r.TB_BUND4_NACK_PDSCH_MCS0,
r.TB_BUND4_NACK_PDSCH_MCS1,
r.TB_BUND4_NACK_PDSCH_MCS2,
r.TB_BUND4_NACK_PDSCH_MCS3,
r.TB_BUND4_NACK_PDSCH_MCS4,
r.TB_BUND4_NACK_PDSCH_MCS5,
r.TB_BUND4_NACK_PDSCH_MCS6,
r.TB_BUND4_NACK_PDSCH_MCS7,
r.TB_BUND4_NACK_PDSCH_MCS8,
r.TB_BUND4_NACK_PDSCH_MCS9,
r.TB_BUND4_NACK_PDSCH_MCS10,
r.TB_BUND4_NACK_PDSCH_MCS11,
r.TB_BUND4_NACK_PDSCH_MCS12,
r.TB_BUND4_NACK_PDSCH_MCS13,
r.TB_BUND4_NACK_PDSCH_MCS14,
r.TB_BUND4_NACK_PDSCH_MCS15,
r.TB_BUND4_NACK_PDSCH_MCS16,
r.TB_BUND4_NACK_PDSCH_MCS17,
r.TB_BUND4_NACK_PDSCH_MCS18,
r.TB_BUND4_NACK_PDSCH_MCS19,
r.TB_BUND4_NACK_PDSCH_MCS20,
r.TB_BUND4_NACK_PDSCH_MCS21,
r.TB_BUND4_NACK_PDSCH_MCS22,
r.TB_BUND4_NACK_PDSCH_MCS23,
r.TB_BUND4_NACK_PDSCH_MCS24,
r.TB_BUND4_NACK_PDSCH_MCS25,
r.TB_BUND4_NACK_PDSCH_MCS26,
r.TB_BUND4_NACK_PDSCH_MCS27,
r.TB_BUND4_NACK_PDSCH_MCS28,
r.UE_DRB_DL_DATA_NON_GBR,
r.PDCP_RET_DL_DEL_MEAN_NON_GBR,
r.UE_DRB_UL_DATA_QCI_1,
r.UE_DRB_UL_DATA_NON_GBR,
r.PDCCH_ORDER_ATT,
r.PDCCH_INIT_ORDER_ATT,
r.PDCCH_ORDER_SUCCESS,
r.D_PREAMB_UNAVAIL,
r.D_PREAMB_PDCCH_UNAVAIL,
r.D_PREAMB_HO_UNAVAIL,
r.CELL_LOAD_UL_IN_SYNC,
r.CELL_LOAD_UL_IN_SYNC_AVG,
r.CELL_LOAD_UNL_POW_RES,
r.CELL_LOAD_UL_OUT_SYNC_0_05,
r.CELL_LOAD_UL_OUT_SYNC_05_025,
r.CELL_LOAD_UL_OUT_SYNC_025_10,
r.CELL_LOAD_UL_OUT_SYNC_10_100,
r.CELL_LOAD_UL_OUT_SYNC_100_INF,
r.PUSCH_1ST_TRANS_MCS0,
r.PUSCH_1ST_TRANS_MCS1,
r.PUSCH_1ST_TRANS_MCS2,
r.PUSCH_1ST_TRANS_MCS3,
r.PUSCH_1ST_TRANS_MCS4,
r.PUSCH_1ST_TRANS_MCS5,
r.PUSCH_1ST_TRANS_MCS6,
r.PUSCH_1ST_TRANS_MCS7,
r.PUSCH_1ST_TRANS_MCS8,
r.PUSCH_1ST_TRANS_MCS9,
r.PUSCH_1ST_TRANS_MCS10,
r.PUSCH_1ST_TRANS_MCS11,
r.PUSCH_1ST_TRANS_MCS12,
r.PUSCH_1ST_TRANS_MCS13,
r.PUSCH_1ST_TRANS_MCS14,
r.PUSCH_1ST_TRANS_MCS15,
r.PUSCH_1ST_TRANS_MCS16,
r.PUSCH_1ST_TRANS_MCS17,
r.PUSCH_1ST_TRANS_MCS18,
r.PUSCH_1ST_TRANS_MCS19,
r.PUSCH_1ST_TRANS_MCS20,
r.PUSCH_1ST_TRANS_MCS21,
r.PUSCH_1ST_TRANS_MCS22,
r.PUSCH_1ST_TRANS_MCS23,
r.PUSCH_1ST_TRANS_MCS24,
r.PUSCH_1ST_TRANS_NACK_MCS0,
r.PUSCH_1ST_TRANS_NACK_MCS1,
r.PUSCH_1ST_TRANS_NACK_MCS2,
r.PUSCH_1ST_TRANS_NACK_MCS3,
r.PUSCH_1ST_TRANS_NACK_MCS4,
r.PUSCH_1ST_TRANS_NACK_MCS5,
r.PUSCH_1ST_TRANS_NACK_MCS6,
r.PUSCH_1ST_TRANS_NACK_MCS7,
r.PUSCH_1ST_TRANS_NACK_MCS8,
r.PUSCH_1ST_TRANS_NACK_MCS9,
r.PUSCH_1ST_TRANS_NACK_MCS10,
r.PUSCH_1ST_TRANS_NACK_MCS11,
r.PUSCH_1ST_TRANS_NACK_MCS12,
r.PUSCH_1ST_TRANS_NACK_MCS13,
r.PUSCH_1ST_TRANS_NACK_MCS14,
r.PUSCH_1ST_TRANS_NACK_MCS15,
r.PUSCH_1ST_TRANS_NACK_MCS16,
r.PUSCH_1ST_TRANS_NACK_MCS17,
r.PUSCH_1ST_TRANS_NACK_MCS18,
r.PUSCH_1ST_TRANS_NACK_MCS19,
r.PUSCH_1ST_TRANS_NACK_MCS20,
r.PUSCH_1ST_TRANS_NACK_MCS21,
r.PUSCH_1ST_TRANS_NACK_MCS22,
r.PUSCH_1ST_TRANS_NACK_MCS23,
r.PUSCH_1ST_TRANS_NACK_MCS24,
r.TB_BAD_PUSCH_MCS21,
r.TB_BAD_PUSCH_MCS22,
r.TB_BAD_PUSCH_MCS23,
r.TB_BAD_PUSCH_MCS24,
r.UE_DRB_DL_DATA_QCI_2,
r.UE_DRB_DL_DATA_QCI_3,
r.UE_DRB_DL_DATA_QCI_4,
r.PDCP_RET_DL_DEL_MEAN_QCI_3,
r.PDCP_RET_DL_DEL_MEAN_QCI_4,
r.RACH_STP_ATT_DEDICATED,
r.PDCP_SDU_DL_QCI_2,
r.PDCP_SDU_DL_QCI_3,
r.PDCP_SDU_DL_QCI_4,
r.PDCP_SDU_DISC_DL_QCI_2,
r.PDCP_SDU_DISC_DL_QCI_3,
r.PDCP_SDU_DISC_DL_QCI_4,
r.PDSCH_TRANS_USING_MCS29,
r.PDSCH_TRANS_USING_MCS30,
r.PDSCH_TRANS_USING_MCS31,
r.PDSCH_TRANS_NACK_MCS29,
r.PDSCH_TRANS_NACK_MCS30,
r.PDSCH_TRANS_NACK_MCS31,
r.TB_BAD_PDSCH_MCS29,
r.TB_BAD_PDSCH_MCS30,
r.TB_BAD_PDSCH_MCS31,
r.TB_BUND2_NACK_PDSCH_MCS29,
r.TB_BUND3_NACK_PDSCH_MCS29,
r.TB_BUND4_NACK_PDSCH_MCS29,
r.TB_BUND2_NACK_PDSCH_MCS30,
r.TB_BUND3_NACK_PDSCH_MCS30,
r.TB_BUND4_NACK_PDSCH_MCS30,
r.TB_BUND2_NACK_PDSCH_MCS31,
r.TB_BUND3_NACK_PDSCH_MCS31,
r.TB_BUND4_NACK_PDSCH_MCS31,
r.MEAN_PRB_AVAIL_PDSCH,
r.MEAN_PRB_AVAIL_PUSCH,
r.NUM_RRC_CONN_UE_AVG,
r.NUM_CELL_LOAD_ACT_UE_AVG,
r.PDCP_SDU_LOSS_UL,
r.PDCP_SDU_LOSS_UL_QCI_1,
r.PDCP_SDU_LOSS_UL_QCI_2,
r.PDCP_SDU_LOSS_UL_QCI_3,
r.PDCP_SDU_LOSS_UL_QCI_4,
r.PDCP_SDU_LOSS_DL,
r.PDCP_SDU_LOSS_DL_QCI_1,
r.PDCP_SDU_LOSS_DL_QCI_2,
r.PDCP_SDU_LOSS_DL_QCI_3,
r.PDCP_SDU_LOSS_DL_QCI_4,
r.PDCP_SDU_UL_QCI_2,
r.PDCP_SDU_UL_QCI_3,
r.PDCP_SDU_UL_QCI_4,
r.ACTIVE_UE_CAT_1_AVG,
r.ACTIVE_UE_CAT_2_AVG,
r.ACTIVE_UE_CAT_3_AVG,
r.ACTIVE_UE_CAT_4_AVG,
r.ACTIVE_UE_CAT_5_AVG,
r.CA_DL_CAP_UE_AVG,
r.CA_SCELL_CONF_UE_AVG,
r.CA_SCELL_ACTIVE_UE_AVG,
r.NUM_WARN_ETWS_PRIM,
r.NUM_WARN_ETWS_SEC,
r.NUM_WARN_CMAS,
r.SUM_ACTIVE_UE_DATA_DL,
r.DENOM_ACTIVE_UE_DATA_DL,
r.SUM_ACTIVE_UE_DATA_UL,
r.DENOM_ACTIVE_UE_DATA_UL,
r.SUM_RRC_CONN_UE,
r.DENOM_RRC_CONN_UE,
r.SUM_ACTIVE_UE,
r.DENOM_ACTIVE_UE
  FROM NOKLTE_PS_LCELLD_MNC1_RAW r
 INNER JOIN OBJECTS_SP_LTE o
    ON r.LNBTS_ID = o.LNBTS_ID
   AND r.LNCEL_ID = o.LNCEL_ID
 WHERE r.PERIOD_START_TIME BETWEEN TO_DATE(''' || P_FECHA_DESDE ||''', ''DD.MM.YYYY HH24'')
                             AND TO_DATE('''||P_FECHA_HASTA ||''', ''DD.MM.YYYY HH24'')';

  OPEN cur FOR sql_stmt;
  LOOP
    FETCH cur BULK COLLECT INTO t_array_col LIMIT limit_in;
    BEGIN
      FORALL i IN 1 .. t_array_col.COUNT SAVE EXCEPTIONS
        INSERT INTO NOKLTE_PS_LCELLD_MNC1_RAW VALUES t_array_col (i);
        
    EXCEPTION WHEN v_bulk_errors THEN
    FOR i in 1..SQL%BULK_EXCEPTIONS.COUNT LOOP
    l_errno := sql%bulk_exceptions(i).error_code;
    l_msg   := sqlerrm(-l_errno);
    l_idx   := sql%bulk_exceptions(i).error_index;

    Dbms_output.put_line(
   'Error cod:' || l_errno ||
   'Mensaje: ' || l_msg );
    END LOOP;  
      
    END;
    
    EXIT WHEN cur%NOTFOUND;
  END LOOP;
  COMMIT;
  CLOSE cur;

  exception
  when others then
  dbms_output.put_line (sqlerrm);

END;

/
