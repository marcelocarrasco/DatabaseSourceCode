--------------------------------------------------------
--  DDL for View LTE_5060E_HOUR
--------------------------------------------------------

  CREATE OR REPLACE VIEW "HARRIAGUE"."LTE_5060E_HOUR" ("PERIOD_START_TIME", "CO_NAME", "LTE_5060E_NUM_1", "LTE_5060E_DEN_1", "LTE_5060E_NUM_2", "LTE_5060E_DEN_2", "LTE_5060E") AS 
  SELECT TO_DATE(SUBSTR( TO_CHAR( PERIOD_START_TIME, 'DD/MM/RRRR HH24:MI'), 0, 13),'DD/MM/YYYY HH24:MI') AS PERIOD_START_TIME,
      CO_NAME, SUM(LTE_5060E_NUM_1) AS LTE_5060E_NUM_1, SUM(LTE_5060E_DEN_1) AS LTE_5060E_DEN_1,
      SUM(LTE_5060E_NUM_2) AS LTE_5060E_NUM_2, SUM(LTE_5060E_DEN_2) AS LTE_5060E_DEN_2,
ROUND (((DECODE (SUM(LTE_5060E_DEN_1), 0, 0, SUM(LTE_5060E_NUM_1) / SUM(LTE_5060E_DEN_1)) *
              DECODE (SUM(LTE_5060E_DEN_2), 0, 0, SUM(LTE_5060E_NUM_2) / SUM(LTE_5060E_DEN_2)))*100),2) as LTE_5060E
FROM LTE_5060E
GROUP BY TO_DATE(SUBSTR( TO_CHAR( PERIOD_START_TIME, 'DD/MM/RRRR HH24:MI'), 0, 13),'DD/MM/YYYY HH24:MI') , CO_NAME
;
