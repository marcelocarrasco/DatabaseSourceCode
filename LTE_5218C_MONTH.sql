--------------------------------------------------------
--  DDL for View LTE_5218C_MONTH
--------------------------------------------------------

  CREATE OR REPLACE VIEW "HARRIAGUE"."LTE_5218C_MONTH" ("FECHA", "CO_NAME", "INT_ID", "LTE_5218C_NUM", "LTE_5218C_DEN", "LTE_5218C", "SIGN_CONN_ESTAB_COMP", "SIGN_CONN_ESTAB_ATT_MO_S", "SIGN_CONN_ESTAB_ATT_MT", "SIGN_CONN_ESTAB_ATT_MO_D", "SIGN_CONN_ESTAB_ATT_OTHERS", "SIGN_CONN_ESTAB_ATT_EMG") AS 
  SELECT TRUNC( FECHA  , 'MONTH') AS FECHA,
    CO_NAME, INT_ID,
    SUM(LTE_5218C_NUM) AS LTE_5218C_NUM,
    SUM(LTE_5218C_DEN) AS LTE_5218C_DEN,
    ROUND (((DECODE (SUM(LTE_5218C_DEN), 0, 0, SUM(LTE_5218C_NUM) / SUM(LTE_5218C_DEN)) )*100),2) as LTE_5218C,
    SUM(SIGN_CONN_ESTAB_COMP) AS  SIGN_CONN_ESTAB_COMP,
    SUM(SIGN_CONN_ESTAB_ATT_MO_S) AS SIGN_CONN_ESTAB_ATT_MO_S,
    SUM(SIGN_CONN_ESTAB_ATT_MT) AS SIGN_CONN_ESTAB_ATT_MT,
    SUM(SIGN_CONN_ESTAB_ATT_MO_D) AS SIGN_CONN_ESTAB_ATT_MO_D,
    SUM(SIGN_CONN_ESTAB_ATT_OTHERS) AS SIGN_CONN_ESTAB_ATT_OTHERS,
    SUM(SIGN_CONN_ESTAB_ATT_EMG) AS SIGN_CONN_ESTAB_ATT_EMG
FROM LTE_5218C_HISTORICAL
GROUP BY TRUNC( FECHA  , 'MONTH'), INT_ID, CO_NAME
;
